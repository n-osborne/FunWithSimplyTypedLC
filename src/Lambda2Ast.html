<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_HADDOCK ignore-exports #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{-|
Module : Lambda2Ast
Copyright : (c) 2018 Nicolas Osborne
Licence : BSD 3-clauses

Provide the function pg2ast which turn a program written in Simply Typed Lambda
Calculus into an Abstract Syntax Tree.

A program in Simply Typed Lambda Calculus is divided into two main parts:

* An @Assignations@ part containing assignations instruction of the form:

    @
    let id Exp
    @

    Where @id@ is an identificator and @Exp@ is a simply styped lambda
    expression.

* A @Program@ part containing the actual computation which may contain @id@
  previously defined in the @Assignations@ part.
-}</span><span>
</span><a name="line-24"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lambda2Ast</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Lambda2Ast.html#AST"><span class="hs-identifier hs-type">AST</span></a><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda2Ast.html#name"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda2Ast.html#ltype"><span class="hs-identifier hs-var">ltype</span></a><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda2Ast.html#size"><span class="hs-identifier hs-var">size</span></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda2Ast.html#below"><span class="hs-identifier hs-var">below</span></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda2Ast.html#left"><span class="hs-identifier hs-var">left</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda2Ast.html#right"><span class="hs-identifier hs-var">right</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda2Ast.html#file2ast"><span class="hs-identifier hs-var">file2ast</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda2Ast.html#exp2ast"><span class="hs-identifier hs-var">exp2ast</span></a><span>
</span><a name="line-34"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="Utils.html"><span class="hs-identifier">Utils</span></a><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">-- * Type declaration</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">-- | Abstract Syntax Tree type declaration.</span><span>
</span><a name="line-41"></a><span class="hs-keyword">data</span><span> </span><a name="AST"><a href="Lambda2Ast.html#AST"><span class="hs-identifier">AST</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-comment">-- | Correspond to the constant of the language. </span><span>
</span><a name="line-43"></a><span>  </span><a name="Leave"><a href="Lambda2Ast.html#Leave"><span class="hs-identifier">Leave</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="name"><a href="Lambda2Ast.html#name"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-44"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="ltype"><a href="Lambda2Ast.html#ltype"><span class="hs-identifier">ltype</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-45"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="size"><a href="Lambda2Ast.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ size of the 'AST'</span><span>
</span><a name="line-46"></a><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-47"></a><span>  </span><span class="hs-comment">-- | Correspond to the unary operators of the language.</span><span>
</span><a name="line-48"></a><span>  </span><a name="Unary"><a href="Lambda2Ast.html#Unary"><span class="hs-identifier">Unary</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="name"><a href="Lambda2Ast.html#name"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-49"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="ltype"><a href="Lambda2Ast.html#ltype"><span class="hs-identifier">ltype</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-50"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="size"><a href="Lambda2Ast.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-51"></a><span>        </span><span class="hs-special">,</span><span> </span><a name="below"><a href="Lambda2Ast.html#below"><span class="hs-identifier">below</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda2Ast.html#AST"><span class="hs-identifier hs-type">AST</span></a><span> </span><span class="hs-comment">-- ^ argument of the operator</span><span>
</span><a name="line-52"></a><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-comment">-- | Correspond to the binary operators of the language.</span><span>
</span><a name="line-54"></a><span>  </span><a name="Binary"><a href="Lambda2Ast.html#Binary"><span class="hs-identifier">Binary</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="name"><a href="Lambda2Ast.html#name"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-55"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="ltype"><a href="Lambda2Ast.html#ltype"><span class="hs-identifier">ltype</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-56"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="size"><a href="Lambda2Ast.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-57"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="left"><a href="Lambda2Ast.html#left"><span class="hs-identifier">left</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda2Ast.html#AST"><span class="hs-identifier hs-type">AST</span></a><span> </span><span class="hs-comment">-- ^ first argument of the binary operator</span><span>
</span><a name="line-58"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="right"><a href="Lambda2Ast.html#right"><span class="hs-identifier">right</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda2Ast.html#AST"><span class="hs-identifier hs-type">AST</span></a><span> </span><span class="hs-comment">-- ^second argument of the binary operator</span><span>
</span><a name="line-59"></a><span>         </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-comment">-- * Main programs</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- | Turn a source file into the corresponding 'AST'.</span><span>
</span><a name="line-64"></a><span class="hs-comment">--</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- A source file must contain two main parts deliminated by the three following</span><span>
</span><a name="line-66"></a><span class="hs-comment">--key words in that order: @Assignations@, @Program@, @End@. The assignation part</span><span>
</span><a name="line-67"></a><span class="hs-comment">--(between the two first key words) is a series of assignation instruction (with</span><span>
</span><a name="line-68"></a><span class="hs-comment">--the @let@ key word) and the program part (between the two lasts key words) is</span><span>
</span><a name="line-69"></a><span class="hs-comment">--the actual computation of which the source file is a description. The program</span><span>
</span><a name="line-70"></a><span class="hs-comment">--part may contain the identificators declared in the assignation part.</span><span>
</span><a name="line-71"></a><span class="hs-comment">--</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- [@input@]: The content of the source file.</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- [@output@]: the corresponding 'AST' type checked.</span><span>
</span><a name="line-74"></a><span class="hs-identifier">file2ast</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda2Ast.html#AST"><span class="hs-identifier hs-type">AST</span></a><span>
</span><a name="line-75"></a><a name="file2ast"><a href="Lambda2Ast.html#file2ast"><span class="hs-identifier">file2ast</span></a></a><span> </span><a name="local-6989586621679020773"><a href="#local-6989586621679020773"><span class="hs-identifier">file</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#createAST"><span class="hs-identifier hs-var">createAST</span></a><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#file2pg"><span class="hs-identifier hs-var">file2pg</span></a><span> </span><a href="#local-6989586621679020773"><span class="hs-identifier hs-var">file</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Return the corresponding 'AST' of the given expression.</span><span>
</span><a name="line-78"></a><span class="hs-comment">--</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- [@input@]: A well formed expression without any identificator, a &quot;all in one&quot;</span><span>
</span><a name="line-80"></a><span class="hs-comment">-- lambda expression.</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- [@output@]: The corresponding 'AST' type checked.</span><span>
</span><a name="line-82"></a><span class="hs-identifier">exp2ast</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda2Ast.html#AST"><span class="hs-identifier hs-type">AST</span></a><span>
</span><a name="line-83"></a><a name="exp2ast"><a href="Lambda2Ast.html#exp2ast"><span class="hs-identifier">exp2ast</span></a></a><span> </span><a name="local-6989586621679020774"><a href="#local-6989586621679020774"><span class="hs-identifier">exp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#createAST"><span class="hs-identifier hs-var">createAST</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">words</span><span> </span><a href="#local-6989586621679020774"><span class="hs-identifier hs-var">exp</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- * Build the Abstract Syntax Tree</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-comment">-- | Create the 'AST' corresponding to the given list of tokens.</span><span>
</span><a name="line-88"></a><span class="hs-comment">--</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- This function defines the syntax of the language.</span><span>
</span><a name="line-90"></a><span class="hs-comment">--</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- [@input@]: the list of tokens representing the program.</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- [@output@]: the corresponding 'AST' type checked.</span><span>
</span><a name="line-93"></a><span class="hs-identifier">createAST</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda2Ast.html#AST"><span class="hs-identifier hs-type">AST</span></a><span>
</span><a name="line-94"></a><a name="createAST"><a href="Lambda2Ast.html#createAST"><span class="hs-identifier">createAST</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679020983"><a href="#local-6989586621679020983"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679020984"><a href="#local-6989586621679020984"><span class="hs-identifier">ns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;lambda&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;apply&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;pi&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679020985"><a href="#local-6989586621679020985"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#createAST"><span class="hs-identifier hs-var">createAST</span></a><span> </span><a href="#local-6989586621679020984"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-96"></a><span>                                         </span><a name="local-6989586621679020986"><a href="#local-6989586621679020986"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#createAST"><span class="hs-identifier hs-var">createAST</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679020984"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>                                     </span><span class="hs-keyword">in</span><span> </span><a href="Lambda2Ast.html#Binary"><span class="hs-identifier hs-var">Binary</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-98"></a><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#computeBinaryType"><span class="hs-identifier hs-var">computeBinaryType</span></a><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ltype</span><span> </span><a href="#local-6989586621679020985"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ltype</span><span> </span><a href="#local-6989586621679020986"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679020985"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679020986"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">left</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020985"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-101"></a><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">right</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020986"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-102"></a><span>                                               </span><span class="hs-special">}</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;first&quot;</span><span class="hs-special">,</span><span class="hs-string">&quot;second&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679020987"><a href="#local-6989586621679020987"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#createAST"><span class="hs-identifier hs-var">createAST</span></a><span> </span><a href="#local-6989586621679020984"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-104"></a><span>                              </span><span class="hs-keyword">in</span><span> </span><a href="Lambda2Ast.html#Unary"><span class="hs-identifier hs-var">Unary</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-105"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#computePairElim"><span class="hs-identifier hs-var">computePairElim</span></a><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">ltype</span><span> </span><a href="#local-6989586621679020987"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679020987"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>                                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">below</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020987"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-108"></a><span>                                       </span><span class="hs-special">}</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;succ&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679020988"><a href="#local-6989586621679020988"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#createAST"><span class="hs-identifier hs-var">createAST</span></a><span> </span><a href="#local-6989586621679020984"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="Lambda2Ast.html#Unary"><span class="hs-identifier hs-var">Unary</span></a><span> </span><span class="hs-string">&quot;succ&quot;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ltype</span><span> </span><a href="#local-6989586621679020988"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-operator hs-var">+</span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679020988"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679020988"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-110"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;zero&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#Leave"><span class="hs-identifier hs-var">Leave</span></a><span> </span><span class="hs-string">&quot;zero&quot;</span><span> </span><span class="hs-string">&quot;nat&quot;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;true&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#Leave"><span class="hs-identifier hs-var">Leave</span></a><span> </span><span class="hs-string">&quot;true&quot;</span><span> </span><span class="hs-string">&quot;bool&quot;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;false&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#Leave"><span class="hs-identifier hs-var">Leave</span></a><span> </span><span class="hs-string">&quot;false&quot;</span><span> </span><span class="hs-string">&quot;bool&quot;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;null&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#Leave"><span class="hs-identifier hs-var">Leave</span></a><span> </span><span class="hs-string">&quot;null&quot;</span><span> </span><span class="hs-string">&quot;empty&quot;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#Leave"><span class="hs-identifier hs-var">Leave</span></a><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-string">&quot;char&quot;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-115"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><span class="hs-char">':'</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679020989"><a href="#local-6989586621679020989"><span class="hs-identifier">splitedVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Utils.html#oneSplit"><span class="hs-identifier hs-var">oneSplit</span></a><span> </span><span class="hs-char">':'</span><span> </span><a href="#local-6989586621679020983"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>                     </span><a name="local-6989586621679020990"><a href="#local-6989586621679020990"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679020989"><span class="hs-identifier hs-var">splitedVar</span></a><span>
</span><a name="line-117"></a><span>                     </span><a name="local-6989586621679020991"><a href="#local-6989586621679020991"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679020989"><span class="hs-identifier hs-var">splitedVar</span></a><span>
</span><a name="line-118"></a><span>                 </span><span class="hs-keyword">in</span><span> </span><a href="Lambda2Ast.html#Leave"><span class="hs-identifier hs-var">Leave</span></a><span> </span><a href="#local-6989586621679020990"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679020991"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#Leave"><span class="hs-identifier hs-var">Leave</span></a><span> </span><span class="hs-string">&quot;Error&quot;</span><span> </span><span class="hs-string">&quot;Error&quot;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-120"></a><span>         </span><span>
</span><a name="line-121"></a><span class="hs-comment">-- * Type manipulations</span><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-comment">-- | Given two types and a binary operator, compute the expression's type.</span><span>
</span><a name="line-124"></a><span class="hs-comment">--</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- [@input@]: operator name</span><span>
</span><a name="line-126"></a><span class="hs-comment">-- [@input@]: type of the first argument</span><span>
</span><a name="line-127"></a><span class="hs-comment">-- [@input@]: type of the second argument</span><span>
</span><a name="line-128"></a><span class="hs-comment">-- [@output@]: type of the expression</span><span>
</span><a name="line-129"></a><span class="hs-identifier">computeBinaryType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span>
</span><a name="line-130"></a><a name="computeBinaryType"><a href="Lambda2Ast.html#computeBinaryType"><span class="hs-identifier">computeBinaryType</span></a></a><span> </span><a name="local-6989586621679020992"><a href="#local-6989586621679020992"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679020993"><a href="#local-6989586621679020993"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679020994"><a href="#local-6989586621679020994"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-131"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020992"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;lambda&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#computeAbstractionType"><span class="hs-identifier hs-var">computeAbstractionType</span></a><span> </span><a href="#local-6989586621679020993"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679020994"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-132"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020992"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;apply&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#computeApplicationType"><span class="hs-identifier hs-var">computeApplicationType</span></a><span> </span><a href="#local-6989586621679020993"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679020994"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-133"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020992"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;pi&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#computePairType"><span class="hs-identifier hs-var">computePairType</span></a><span> </span><a href="#local-6989586621679020993"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679020994"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- | Given the binder's type and the body's type, compute the type of the</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- abstraction.</span><span>
</span><a name="line-137"></a><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- [@input@]: type of the binder.</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- [@input@]: type of the body.</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- [@output@]: type of the expression.</span><span>
</span><a name="line-141"></a><span class="hs-identifier">computeAbstractionType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span>
</span><a name="line-142"></a><a name="computeAbstractionType"><a href="Lambda2Ast.html#computeAbstractionType"><span class="hs-identifier">computeAbstractionType</span></a></a><span> </span><a name="local-6989586621679020995"><a href="#local-6989586621679020995"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679020996"><a href="#local-6989586621679020996"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020995"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; -&gt; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#parenthesizeType"><span class="hs-identifier hs-var">parenthesizeType</span></a><span> </span><a href="#local-6989586621679020996"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- | Given the type of a function and the type of an argument, compute the type</span><span>
</span><a name="line-145"></a><span class="hs-comment">-- of the application.</span><span>
</span><a name="line-146"></a><span class="hs-comment">--</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- [@input@]: the type of the function.</span><span>
</span><a name="line-148"></a><span class="hs-comment">-- [@input@]: the type of the argument.</span><span>
</span><a name="line-149"></a><span class="hs-comment">-- [@output@]: the type of the expression.</span><span>
</span><a name="line-150"></a><span class="hs-identifier">computeApplicationType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span>
</span><a name="line-151"></a><a name="computeApplicationType"><a href="Lambda2Ast.html#computeApplicationType"><span class="hs-identifier">computeApplicationType</span></a></a><span> </span><a name="local-6989586621679020997"><a href="#local-6989586621679020997"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679020998"><a href="#local-6989586621679020998"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-152"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#isFunction"><span class="hs-identifier hs-var">isFunction</span></a><span> </span><a href="#local-6989586621679020997"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span> </span><a href="Utils.html#stripPar"><span class="hs-identifier hs-var">stripPar</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#splitType"><span class="hs-identifier hs-var">splitType</span></a><span> </span><a href="#local-6989586621679020997"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679020998"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#splitType"><span class="hs-identifier hs-var">splitType</span></a><span> </span><a href="#local-6989586621679020997"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Type Error&quot;</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-comment">-- | Given the type of two expression, compute the type of the pair.</span><span>
</span><a name="line-156"></a><span class="hs-comment">--</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- [@input@]: the type of the first element of the pair.</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- [@input@]: the type of the second element of the pair.</span><span>
</span><a name="line-159"></a><span class="hs-comment">-- [@output@]: the type of the expression.</span><span>
</span><a name="line-160"></a><span class="hs-identifier">computePairType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span>
</span><a name="line-161"></a><a name="computePairType"><a href="Lambda2Ast.html#computePairType"><span class="hs-identifier">computePairType</span></a></a><span> </span><a name="local-6989586621679020999"><a href="#local-6989586621679020999"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679021000"><a href="#local-6989586621679021000"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#parenthesizeType"><span class="hs-identifier hs-var">parenthesizeType</span></a><span> </span><a href="#local-6989586621679020999"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; x &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#parenthesizeType"><span class="hs-identifier hs-var">parenthesizeType</span></a><span> </span><a href="#local-6989586621679021000"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- | Prepare a type to be combined with another type. Put a pair parenthesis</span><span>
</span><a name="line-164"></a><span class="hs-comment">-- around the type if it is a complex type.</span><span>
</span><a name="line-165"></a><span class="hs-comment">--</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- [@input@]: the type</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- [@output@]: the same type</span><span>
</span><a name="line-168"></a><span class="hs-identifier">parenthesizeType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span>
</span><a name="line-169"></a><a name="parenthesizeType"><a href="Lambda2Ast.html#parenthesizeType"><span class="hs-identifier">parenthesizeType</span></a></a><span> </span><a name="local-6989586621679021001"><a href="#local-6989586621679021001"><span class="hs-identifier">ltype</span></a></a><span>
</span><a name="line-170"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021002"><span class="hs-identifier hs-var">isComplex</span></a><span> </span><a href="#local-6989586621679021001"><span class="hs-identifier hs-var">ltype</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679021001"><span class="hs-identifier hs-var">ltype</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021001"><span class="hs-identifier hs-var">ltype</span></a><span>
</span><a name="line-172"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">isComplex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-173"></a><span>        </span><a name="local-6989586621679021002"><a href="#local-6989586621679021002"><span class="hs-identifier">isComplex</span></a></a><span> </span><a name="local-6989586621679021003"><a href="#local-6989586621679021003"><span class="hs-identifier">ltype</span></a></a><span>
</span><a name="line-174"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><span class="hs-char">'x'</span><span> </span><a href="#local-6989586621679021003"><span class="hs-identifier hs-var">ltype</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-175"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><span class="hs-char">'&gt;'</span><span> </span><a href="#local-6989586621679021003"><span class="hs-identifier hs-var">ltype</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-176"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- | Predicate. Determine whether a type is the type of a function.</span><span>
</span><a name="line-179"></a><span class="hs-comment">--</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- [@input@]: a type expression.</span><span>
</span><a name="line-181"></a><span class="hs-comment">-- [@output@]: true if the type is the type of a function, false otherwise.</span><span>
</span><a name="line-182"></a><span class="hs-identifier">isFunction</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-183"></a><a name="isFunction"><a href="Lambda2Ast.html#isFunction"><span class="hs-identifier">isFunction</span></a></a><span> </span><a name="local-6989586621679021004"><a href="#local-6989586621679021004"><span class="hs-identifier">ltype</span></a></a><span>
</span><a name="line-184"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021005"><span class="hs-identifier hs-var">findOp</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679021004"><span class="hs-identifier hs-var">ltype</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'&gt;'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-185"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-186"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">findOp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-187"></a><span>        </span><a name="local-6989586621679021005"><a href="#local-6989586621679021005"><span class="hs-identifier">findOp</span></a></a><span> </span><a name="local-6989586621679021006"><a href="#local-6989586621679021006"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'e'</span><span>
</span><a name="line-188"></a><span>        </span><span class="hs-identifier">findOp</span><span> </span><a name="local-6989586621679021007"><a href="#local-6989586621679021007"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679021008"><a href="#local-6989586621679021008"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021009"><a href="#local-6989586621679021009"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021007"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679021008"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'-'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'&gt;'</span><span>
</span><a name="line-190"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021008"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'('</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021005"><span class="hs-identifier hs-var">findOp</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021007"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679021009"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-191"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021008"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">')'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021005"><span class="hs-identifier hs-var">findOp</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021007"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679021009"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-192"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021005"><span class="hs-identifier hs-var">findOp</span></a><span> </span><a href="#local-6989586621679021007"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679021009"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-comment">-- | Compute type of a pair elimination</span><span>
</span><a name="line-195"></a><span class="hs-comment">--</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- [@input@]: operator, either @first@ or @second@</span><span>
</span><a name="line-197"></a><span class="hs-comment">-- [@input@]: type of the pair, /ie/ of the from @AxB@</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- [@output@]: type of the expression</span><span>
</span><a name="line-199"></a><span class="hs-identifier">computePairElim</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span>
</span><a name="line-200"></a><a name="computePairElim"><a href="Lambda2Ast.html#computePairElim"><span class="hs-identifier">computePairElim</span></a></a><span> </span><a name="local-6989586621679021010"><a href="#local-6989586621679021010"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679021011"><a href="#local-6989586621679021011"><span class="hs-identifier">pairType</span></a></a><span>
</span><a name="line-201"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021010"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;first&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#splitType"><span class="hs-identifier hs-var">splitType</span></a><span> </span><a href="#local-6989586621679021011"><span class="hs-identifier hs-var">pairType</span></a><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021010"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;second&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#splitType"><span class="hs-identifier hs-var">splitType</span></a><span> </span><a href="#local-6989586621679021011"><span class="hs-identifier hs-var">pairType</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Type Error&quot;</span><span>
</span><a name="line-204"></a><span> </span><span>
</span><a name="line-205"></a><span>  </span><span class="hs-comment">-- TODO output should be a tuple</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- | Split a composed type in its two main parts.</span><span>
</span><a name="line-207"></a><span class="hs-comment">--</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- [@input@]: a composed type</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- [@output@]: the list of the two types composing the composed type</span><span>
</span><a name="line-210"></a><span class="hs-identifier">splitType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-211"></a><a name="splitType"><a href="Lambda2Ast.html#splitType"><span class="hs-identifier">splitType</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-212"></a><span class="hs-identifier">splitType</span><span> </span><a name="local-6989586621679021012"><a href="#local-6989586621679021012"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021013"><span class="hs-identifier hs-var">splitType'</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679021012"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-213"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span>
</span><a name="line-214"></a><span>    </span><span class="hs-identifier">splitType'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-215"></a><span>    </span><a name="local-6989586621679021013"><a href="#local-6989586621679021013"><span class="hs-identifier">splitType'</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679021014"><a href="#local-6989586621679021014"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Utils.html#stripPar"><span class="hs-identifier hs-var">stripPar</span></a><span> </span><a href="#local-6989586621679021014"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">]</span><span>
</span><a name="line-216"></a><span>    </span><span class="hs-identifier">splitType'</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679021015"><a href="#local-6989586621679021015"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;Type Error&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-217"></a><span>    </span><span class="hs-identifier">splitType'</span><span> </span><a name="local-6989586621679021016"><a href="#local-6989586621679021016"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679021017"><a href="#local-6989586621679021017"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679021018"><a href="#local-6989586621679021018"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021019"><a href="#local-6989586621679021019"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021020"><a href="#local-6989586621679021020"><span class="hs-identifier">ns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021016"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679021019"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'-'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Utils.html#stripPar"><span class="hs-identifier hs-var">stripPar</span></a><span> </span><a href="#local-6989586621679021017"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Utils.html#stripPar"><span class="hs-identifier hs-var">stripPar</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679021020"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-219"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021016"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679021019"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'x'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Utils.html#stripPar"><span class="hs-identifier hs-var">stripPar</span></a><span> </span><a href="#local-6989586621679021017"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Utils.html#stripPar"><span class="hs-identifier hs-var">stripPar</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679021020"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-220"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021018"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'('</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021013"><span class="hs-identifier hs-var">splitType'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021016"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021017"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679021018"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021019"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679021020"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021018"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">')'</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021013"><span class="hs-identifier hs-var">splitType'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021016"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021017"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679021018"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021019"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679021020"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021013"><span class="hs-identifier hs-var">splitType'</span></a><span> </span><a href="#local-6989586621679021016"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021017"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679021018"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021019"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679021020"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-comment">-- * Prepare the program into a list of tokens</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-comment">-- | Prepare the content of a file for 'createAST' function.</span><span>
</span><a name="line-227"></a><span class="hs-comment">--</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- [@input@]: The content of a file as described in the specifications.</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- [@output@]: A list of tokens ready for building an AST.</span><span>
</span><a name="line-230"></a><span class="hs-identifier">file2pg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-231"></a><a name="file2pg"><a href="Lambda2Ast.html#file2pg"><span class="hs-identifier">file2pg</span></a></a><span> </span><a name="local-6989586621679021021"><a href="#local-6989586621679021021"><span class="hs-identifier">file</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679021022"><a href="#local-6989586621679021022"><span class="hs-identifier">listTokens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#file2list"><span class="hs-identifier hs-var">file2list</span></a><span> </span><a href="#local-6989586621679021021"><span class="hs-identifier hs-var">file</span></a><span>
</span><a name="line-232"></a><span>                   </span><a name="local-6989586621679021023"><a href="#local-6989586621679021023"><span class="hs-identifier">partA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#extractAssignations"><span class="hs-identifier hs-var">extractAssignations</span></a><span> </span><a href="#local-6989586621679021022"><span class="hs-identifier hs-var">listTokens</span></a><span>
</span><a name="line-233"></a><span>                   </span><a name="local-6989586621679021024"><a href="#local-6989586621679021024"><span class="hs-identifier">partPg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#extractPg"><span class="hs-identifier hs-var">extractPg</span></a><span> </span><a href="#local-6989586621679021022"><span class="hs-identifier hs-var">listTokens</span></a><span>
</span><a name="line-234"></a><span>               </span><span class="hs-keyword">in</span><span> </span><a href="Lambda2Ast.html#preparePg"><span class="hs-identifier hs-var">preparePg</span></a><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#parseA"><span class="hs-identifier hs-var">parseA</span></a><span> </span><a href="#local-6989586621679021023"><span class="hs-identifier hs-var">partA</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679021024"><span class="hs-identifier hs-var">partPg</span></a><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-comment">-- TODO avoid use of length by computing length res when building res</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- in order to do that: read :: x -&gt; y -&gt; [] -&gt; (Int, [])</span><span>
</span><a name="line-238"></a><span class="hs-comment">-- | Turn a String into the corresponding list of tokens.</span><span>
</span><a name="line-239"></a><span class="hs-comment">--</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- Split the string and drop the separators.</span><span>
</span><a name="line-241"></a><span class="hs-comment">-- Separators are whitespace and end of line.</span><span>
</span><a name="line-242"></a><span class="hs-identifier">file2list</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-243"></a><a name="file2list"><a href="Lambda2Ast.html#file2list"><span class="hs-identifier">file2list</span></a></a><span> </span><a name="local-6989586621679021025"><a href="#local-6989586621679021025"><span class="hs-identifier">pg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021026"><span class="hs-identifier hs-var">mydbsplit</span></a><span> </span><span class="hs-char">' '</span><span> </span><span class="hs-char">'\n'</span><span> </span><a href="#local-6989586621679021025"><span class="hs-identifier hs-var">pg</span></a><span>
</span><a name="line-244"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-identifier">mydbsplit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679021027"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679021027"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679021027"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679021027"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679021027"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-246"></a><span>    </span><a name="local-6989586621679021026"><a href="#local-6989586621679021026"><span class="hs-identifier">mydbsplit</span></a></a><span> </span><a name="local-6989586621679021028"><a href="#local-6989586621679021028"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679021029"><a href="#local-6989586621679021029"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-247"></a><span>    </span><span class="hs-identifier">mydbsplit</span><span> </span><a name="local-6989586621679021030"><a href="#local-6989586621679021030"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679021031"><a href="#local-6989586621679021031"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679021032"><a href="#local-6989586621679021032"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021033"><a href="#local-6989586621679021033"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021032"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679021030"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021026"><span class="hs-identifier hs-var">mydbsplit</span></a><span> </span><a href="#local-6989586621679021030"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679021031"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679021033"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-249"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021032"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679021031"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021026"><span class="hs-identifier hs-var">mydbsplit</span></a><span> </span><a href="#local-6989586621679021030"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679021031"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679021033"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-250"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679021034"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679021026"><span class="hs-identifier hs-var">mydbsplit</span></a><span> </span><a href="#local-6989586621679021030"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679021031"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679021034"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679021033"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679021034"><a href="#local-6989586621679021034"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021035"><span class="hs-identifier hs-var">read</span></a><span> </span><a href="#local-6989586621679021030"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679021031"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021032"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679021033"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>            </span><a name="local-6989586621679021035"><a href="#local-6989586621679021035"><span class="hs-identifier">read</span></a></a><span> </span><a name="local-6989586621679021036"><a href="#local-6989586621679021036"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679021037"><a href="#local-6989586621679021037"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-253"></a><span>            </span><span class="hs-identifier">read</span><span> </span><a name="local-6989586621679021038"><a href="#local-6989586621679021038"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679021039"><a href="#local-6989586621679021039"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679021040"><a href="#local-6989586621679021040"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021041"><a href="#local-6989586621679021041"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-254"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021040"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679021038"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-255"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021040"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679021039"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-256"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021040"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679021035"><span class="hs-identifier hs-var">read</span></a><span> </span><a href="#local-6989586621679021038"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679021039"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679021041"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">-- TODO handle commentary section before Assignations</span><span>
</span><a name="line-259"></a><span class="hs-comment">-- | Return the sub-list corresponding to the list of tokens corresponding to</span><span>
</span><a name="line-260"></a><span class="hs-comment">-- the Assignation part of the source file.</span><span>
</span><a name="line-261"></a><span class="hs-identifier">extractAssignations</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-262"></a><a name="extractAssignations"><a href="Lambda2Ast.html#extractAssignations"><span class="hs-identifier">extractAssignations</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-263"></a><span class="hs-identifier">extractAssignations</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679021042"><a href="#local-6989586621679021042"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021043"><a href="#local-6989586621679021043"><span class="hs-identifier">ns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021042"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;Assignations&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#extractAssignations"><span class="hs-identifier hs-var">extractAssignations</span></a><span> </span><a href="#local-6989586621679021043"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-265"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021042"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;Program&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-266"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021042"><span class="hs-identifier hs-var">s</span></a><span class="hs-glyph">:</span><a href="Lambda2Ast.html#extractAssignations"><span class="hs-identifier hs-var">extractAssignations</span></a><span> </span><a href="#local-6989586621679021043"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">-- | Return the sub-list corresponding to the list of tokens corresponding to</span><span>
</span><a name="line-269"></a><span class="hs-comment">-- the Program part of the source file</span><span>
</span><a name="line-270"></a><span class="hs-identifier">extractPg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-271"></a><a name="extractPg"><a href="Lambda2Ast.html#extractPg"><span class="hs-identifier">extractPg</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-272"></a><span class="hs-identifier">extractPg</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679021044"><a href="#local-6989586621679021044"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021045"><a href="#local-6989586621679021045"><span class="hs-identifier">ns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021044"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;Program&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021046"><span class="hs-identifier hs-var">stripEnd</span></a><span> </span><a href="#local-6989586621679021045"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-274"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda2Ast.html#extractPg"><span class="hs-identifier hs-var">extractPg</span></a><span> </span><a href="#local-6989586621679021045"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-275"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679021046"><a href="#local-6989586621679021046"><span class="hs-identifier">stripEnd</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679021047"><a href="#local-6989586621679021047"><span class="hs-identifier">w</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021048"><a href="#local-6989586621679021048"><span class="hs-identifier">ws</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-276"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021047"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;End&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-277"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021047"><span class="hs-identifier hs-var">w</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679021046"><span class="hs-identifier hs-var">stripEnd</span></a><span> </span><a href="#local-6989586621679021048"><span class="hs-identifier hs-var">ws</span></a><span>
</span><a name="line-278"></a><span>          </span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-comment">-- TODO use Data.HashMap.Strict for better time complexity</span><span>
</span><a name="line-280"></a><span class="hs-comment">-- | Parse the Assignation part of the source file.</span><span>
</span><a name="line-281"></a><span class="hs-comment">--</span><span>
</span><a name="line-282"></a><span class="hs-comment">-- [@Input@]: The list of tokens corresponding to the Assignation part of the</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- source file.</span><span>
</span><a name="line-284"></a><span class="hs-comment">-- [@Output@]: A list of assignations. The @head@ of each item is an @id@ and</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- the @tail@ is the @expression@</span><span>
</span><a name="line-286"></a><span class="hs-identifier">parseA</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-287"></a><a name="parseA"><a href="Lambda2Ast.html#parseA"><span class="hs-identifier">parseA</span></a></a><span> </span><a name="local-6989586621679021049"><a href="#local-6989586621679021049"><span class="hs-identifier">tokens</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021050"><span class="hs-identifier hs-var">oneSplit</span></a><span> </span><span class="hs-string">&quot;let&quot;</span><span> </span><a href="#local-6989586621679021049"><span class="hs-identifier hs-var">tokens</span></a><span>
</span><a name="line-288"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679021050"><a href="#local-6989586621679021050"><span class="hs-identifier">oneSplit</span></a></a><span> </span><a name="local-6989586621679021051"><a href="#local-6989586621679021051"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-289"></a><span>        </span><span class="hs-identifier">oneSplit</span><span> </span><a name="local-6989586621679021052"><a href="#local-6989586621679021052"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679021053"><a href="#local-6989586621679021053"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021054"><a href="#local-6989586621679021054"><span class="hs-identifier">ns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021053"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679021052"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021050"><span class="hs-identifier hs-var">oneSplit</span></a><span> </span><a href="#local-6989586621679021053"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679021054"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-291"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679021055"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679021050"><span class="hs-identifier hs-var">oneSplit</span></a><span> </span><a href="#local-6989586621679021052"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679021055"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679021054"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-292"></a><span>          </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679021055"><a href="#local-6989586621679021055"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021056"><span class="hs-identifier hs-var">read</span></a><span> </span><a href="#local-6989586621679021052"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021053"><span class="hs-identifier hs-var">s</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679021054"><span class="hs-identifier hs-var">ns</span></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><span>                </span><a name="local-6989586621679021056"><a href="#local-6989586621679021056"><span class="hs-identifier">read</span></a></a><span> </span><a name="local-6989586621679021057"><a href="#local-6989586621679021057"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-294"></a><span>                </span><span class="hs-identifier">read</span><span> </span><a name="local-6989586621679021058"><a href="#local-6989586621679021058"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679021059"><a href="#local-6989586621679021059"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021060"><a href="#local-6989586621679021060"><span class="hs-identifier">ns</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-295"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021059"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679021058"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-296"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021059"><span class="hs-identifier hs-var">s</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679021056"><span class="hs-identifier hs-var">read</span></a><span> </span><a href="#local-6989586621679021058"><span class="hs-identifier hs-var">str</span></a><span> </span><a href="#local-6989586621679021060"><span class="hs-identifier hs-var">ns</span></a><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">-- | Substitute the Id in the list of tokens corresponding to the program part</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- of the source file by the corresponding list of tokens.</span><span>
</span><a name="line-300"></a><span class="hs-identifier">preparePg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-301"></a><a name="preparePg"><a href="Lambda2Ast.html#preparePg"><span class="hs-identifier">preparePg</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-302"></a><span class="hs-identifier">preparePg</span><span> </span><a name="local-6989586621679021061"><a href="#local-6989586621679021061"><span class="hs-identifier">list1</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679021062"><a href="#local-6989586621679021062"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021063"><a href="#local-6989586621679021063"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679021064"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621679021061"><span class="hs-identifier hs-var">list1</span></a><span> </span><a href="#local-6989586621679021062"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><a href="Lambda2Ast.html#preparePg"><span class="hs-identifier hs-var">preparePg</span></a><span> </span><a href="#local-6989586621679021061"><span class="hs-identifier hs-var">list1</span></a><span> </span><a href="#local-6989586621679021063"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">check</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-304"></a><span>        </span><a name="local-6989586621679021064"><a href="#local-6989586621679021064"><span class="hs-identifier">check</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679021065"><a href="#local-6989586621679021065"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679021065"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-305"></a><span>        </span><span class="hs-identifier">check</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679021066"><a href="#local-6989586621679021066"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679021067"><a href="#local-6989586621679021067"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679021068"><a href="#local-6989586621679021068"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-306"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679021068"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679021066"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679021066"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-307"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679021064"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621679021067"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679021068"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-308"></a></pre></body></html>